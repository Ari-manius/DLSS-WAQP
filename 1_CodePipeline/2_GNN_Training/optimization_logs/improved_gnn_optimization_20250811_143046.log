2025-08-11 14:30:46,476 - INFO - Starting optimization for improved_gnn
2025-08-11 14:30:46,476 - INFO - Log file: optimization_logs/improved_gnn_optimization_20250811_143046.log
2025-08-11 14:30:46,478 - INFO - 🚀 Starting hyperparameter optimization for improved_gnn
2025-08-11 14:30:46,479 - INFO - 📋 Configuration:
2025-08-11 14:30:46,479 - INFO -    Task type: classification
2025-08-11 14:30:46,479 - INFO -    Trials: 5
2025-08-11 14:30:46,479 - INFO -    CV folds: 3
2025-08-11 14:30:46,479 - INFO -    Epochs per trial: 10
2025-08-11 14:30:46,479 - INFO -    Device: mps
2025-08-11 14:30:46,479 - INFO -    Direction: maximize
2025-08-11 14:30:46,481 - INFO - 📊 Class distribution:
2025-08-11 14:30:46,481 - INFO -    Class 0: 267170 samples (70.3%)
2025-08-11 14:30:46,481 - INFO -    Class 1: 110778 samples (29.2%)
2025-08-11 14:30:46,481 - INFO -    Class 2: 1902 samples (0.5%)
2025-08-11 14:30:46,481 - INFO - 🔍 Starting optimization with 5 trials...
2025-08-11 14:30:46,481 - INFO - 🔄 Starting trial 0
2025-08-11 14:30:46,481 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-11 14:30:46,484 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 4, 'dropout': 0.49523139660092586, 'lr': 0.0001665882269229026, 'weight_decay': 0.0040398580357704356, 'oversample_strategy': 'boosted', 'min_samples_factor': 4}
2025-08-11 14:30:46,484 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-11 14:38:48,355 - ERROR -    ❌ Trial 0 failed: invalid low watermark ratio 1.4
2025-08-11 14:38:48,362 - INFO - 🎯 Trial 1/5 (20.0%): Score = -inf
2025-08-11 14:38:48,362 - INFO - 🔄 Starting trial 1
2025-08-11 14:38:48,362 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-11 14:38:48,371 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 4, 'dropout': 0.36983333531567497, 'lr': 0.06868154857152108, 'weight_decay': 0.009003109957869342, 'cb_focal_beta': 0.9995164481259878, 'cb_focal_gamma': 2.055899380266112, 'min_class_boost': 4.201999271319405, 'oversample_strategy': 'boosted', 'min_samples_factor': 4}
2025-08-11 14:38:48,372 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-11 14:46:06,456 - ERROR -    ❌ Trial 1 failed: Invalid buffer size: 13.61 GB
2025-08-11 14:46:06,460 - INFO - 🎯 Trial 2/5 (40.0%): Score = -inf
2025-08-11 14:46:06,460 - INFO - 🔄 Starting trial 2
2025-08-11 14:46:06,461 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-11 14:46:06,469 - INFO -    📊 Parameters: {'hidden_dim': 64, 'num_layers': 2, 'dropout': 0.382189787287855, 'lr': 0.006966338396867611, 'weight_decay': 0.0005069158099423246, 'cb_focal_beta': 0.9995270974957141, 'cb_focal_gamma': 3.9014603234535588, 'min_class_boost': 2.7648459100241607, 'oversample_strategy': 'boosted', 'min_samples_factor': 3}
2025-08-11 14:46:06,469 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-11 14:53:06,909 - ERROR -    ❌ Trial 2 failed: Invalid buffer size: 6.80 GB
2025-08-11 14:53:06,914 - INFO - 🎯 Trial 3/5 (60.0%): Score = -inf
2025-08-11 14:53:06,915 - INFO - 🔄 Starting trial 3
2025-08-11 14:53:06,915 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-11 14:53:06,923 - INFO -    📊 Parameters: {'hidden_dim': 32, 'num_layers': 2, 'dropout': 0.3944468676751244, 'lr': 0.003025262240617683, 'weight_decay': 8.488661639787345e-06, 'oversample_strategy': 'boosted', 'min_samples_factor': 2}
2025-08-11 14:53:06,923 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-11 15:48:30,663 - INFO -    📈 Results: Overall Acc=0.7705
2025-08-11 15:48:30,670 - INFO -    ✅ Trial 3 completed successfully
2025-08-11 15:48:30,672 - INFO - 🎯 Trial 4/5 (80.0%): Score = 0.7705
2025-08-11 15:48:30,672 - INFO - 🔄 Starting trial 4
2025-08-11 15:48:30,672 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-11 15:48:30,679 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 2, 'dropout': 0.4487538164499031, 'lr': 0.04152833599848494, 'weight_decay': 0.004215158189791828, 'oversample_strategy': 'balanced', 'min_samples_factor': 2}
2025-08-11 15:48:30,679 - INFO -    🔬 Running 3-fold cross-validation...
