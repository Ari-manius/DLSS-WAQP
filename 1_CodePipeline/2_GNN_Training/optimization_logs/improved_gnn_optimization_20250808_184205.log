2025-08-08 18:42:05,575 - INFO - Starting optimization for improved_gnn
2025-08-08 18:42:05,575 - INFO - Log file: optimization_logs/improved_gnn_optimization_20250808_184205.log
2025-08-08 18:42:05,577 - INFO - 🚀 Starting hyperparameter optimization for improved_gnn
2025-08-08 18:42:05,577 - INFO - 📋 Configuration:
2025-08-08 18:42:05,577 - INFO -    Task type: classification
2025-08-08 18:42:05,577 - INFO -    Trials: 5
2025-08-08 18:42:05,577 - INFO -    CV folds: 1
2025-08-08 18:42:05,577 - INFO -    Epochs per trial: 50
2025-08-08 18:42:05,577 - INFO -    Device: mps
2025-08-08 18:42:05,577 - INFO -    Direction: maximize
2025-08-08 18:42:05,579 - INFO - 📊 Class distribution:
2025-08-08 18:42:05,579 - INFO -    Class 0: 267170 samples (70.3%)
2025-08-08 18:42:05,579 - INFO -    Class 1: 110778 samples (29.2%)
2025-08-08 18:42:05,579 - INFO -    Class 2: 1902 samples (0.5%)
2025-08-08 18:42:05,579 - INFO - 🔍 Starting optimization with 5 trials...
2025-08-08 18:42:05,579 - INFO - 🔄 Starting trial 0
2025-08-08 18:42:05,579 - INFO -    Device: mps, Task: classification, CV folds: 1
2025-08-08 18:42:05,582 - INFO -    📊 Parameters: {'hidden_dim': 32, 'num_layers': 2, 'dropout': 0.6601592018509576, 'lr': 0.019683245398018467, 'weight_decay': 9.663732851471726e-06, 'cb_focal_beta': 0.9993742391585426, 'cb_focal_gamma': 2.003490771719691, 'min_class_boost': 4.409153803732548, 'oversample_strategy': 'boosted', 'min_samples_factor': 3}
2025-08-08 18:42:05,582 - INFO -    🔬 Running 1-fold cross-validation...
2025-08-08 18:42:05,638 - ERROR -    ❌ Trial 0 failed: k-fold cross-validation requires at least one train/test split by setting n_splits=2 or more, got n_splits=1.
2025-08-08 18:42:05,639 - INFO - 🎯 Trial 1/5 (20.0%): Score = -inf
2025-08-08 18:42:05,639 - INFO - 🔄 Starting trial 1
2025-08-08 18:42:05,639 - INFO -    Device: mps, Task: classification, CV folds: 1
2025-08-08 18:42:05,641 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 3, 'dropout': 0.27723161706977273, 'lr': 0.0010600917474400317, 'weight_decay': 0.0052459460610920815, 'focal_alpha': 2.0128563197243814, 'focal_gamma': 2.3139971660570247, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-08 18:42:05,641 - INFO -    🔬 Running 1-fold cross-validation...
2025-08-08 18:42:05,687 - ERROR -    ❌ Trial 1 failed: k-fold cross-validation requires at least one train/test split by setting n_splits=2 or more, got n_splits=1.
2025-08-08 18:42:05,687 - INFO - 🎯 Trial 2/5 (40.0%): Score = -inf
2025-08-08 18:42:05,688 - INFO - 🔄 Starting trial 2
2025-08-08 18:42:05,688 - INFO -    Device: mps, Task: classification, CV folds: 1
2025-08-08 18:42:05,690 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 4, 'dropout': 0.111328903798567, 'lr': 0.00573778327112198, 'weight_decay': 0.0037034180452195547, 'focal_alpha': 2.047898178256485, 'focal_gamma': 3.222802278989403, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-08 18:42:05,690 - INFO -    🔬 Running 1-fold cross-validation...
2025-08-08 18:42:05,735 - ERROR -    ❌ Trial 2 failed: k-fold cross-validation requires at least one train/test split by setting n_splits=2 or more, got n_splits=1.
2025-08-08 18:42:05,736 - INFO - 🎯 Trial 3/5 (60.0%): Score = -inf
2025-08-08 18:42:05,736 - INFO - 🔄 Starting trial 3
2025-08-08 18:42:05,736 - INFO -    Device: mps, Task: classification, CV folds: 1
2025-08-08 18:42:05,738 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 4, 'dropout': 0.12405097390170963, 'lr': 0.009359015364046017, 'weight_decay': 1.2035998716119164e-06, 'oversample_strategy': 'boosted', 'min_samples_factor': 4}
2025-08-08 18:42:05,738 - INFO -    🔬 Running 1-fold cross-validation...
2025-08-08 18:42:05,784 - ERROR -    ❌ Trial 3 failed: k-fold cross-validation requires at least one train/test split by setting n_splits=2 or more, got n_splits=1.
2025-08-08 18:42:05,784 - INFO - 🎯 Trial 4/5 (80.0%): Score = -inf
2025-08-08 18:42:05,785 - INFO - 🔄 Starting trial 4
2025-08-08 18:42:05,785 - INFO -    Device: mps, Task: classification, CV folds: 1
2025-08-08 18:42:05,787 - INFO -    📊 Parameters: {'hidden_dim': 64, 'num_layers': 4, 'dropout': 0.2115419403141131, 'lr': 0.0008029793235317863, 'weight_decay': 0.006168565138693643, 'focal_alpha': 2.8755785270050875, 'focal_gamma': 3.6816654141720084, 'oversample_strategy': 'boosted', 'min_samples_factor': 4}
2025-08-08 18:42:05,787 - INFO -    🔬 Running 1-fold cross-validation...
2025-08-08 18:42:05,831 - ERROR -    ❌ Trial 4 failed: k-fold cross-validation requires at least one train/test split by setting n_splits=2 or more, got n_splits=1.
2025-08-08 18:42:05,831 - INFO - 🎯 Trial 5/5 (100.0%): Score = -inf
2025-08-08 18:42:05,832 - INFO - 📊 Progress Update - 5 trials completed
2025-08-08 18:42:05,832 - INFO -    🏆 Best score so far: -inf (Trial #0)
2025-08-08 18:42:05,833 - INFO -    ⏱️  ETA: 0.0 minutes remaining
2025-08-08 18:42:05,833 - INFO - 
🎉 OPTIMIZATION COMPLETED!
2025-08-08 18:42:05,833 - INFO - ============================================================
2025-08-08 18:42:05,833 - INFO - 📋 Summary:
2025-08-08 18:42:05,833 - INFO -    Total trials: 5
2025-08-08 18:42:05,833 - INFO -    Best trial: #0
2025-08-08 18:42:05,834 - INFO -    Best value: -inf
2025-08-08 18:42:05,834 - INFO - 🏆 Best parameters:
2025-08-08 18:42:05,834 - INFO -    hidden_dim: 32
2025-08-08 18:42:05,834 - INFO -    num_layers: 2
2025-08-08 18:42:05,834 - INFO -    dropout: 0.6601592018509576
2025-08-08 18:42:05,834 - INFO -    lr: 0.019683245398018467
2025-08-08 18:42:05,834 - INFO -    weight_decay: 9.663732851471726e-06
2025-08-08 18:42:05,834 - INFO -    loss_type: class_balanced_focal
2025-08-08 18:42:05,834 - INFO -    cb_focal_beta: 0.9993742391585426
2025-08-08 18:42:05,834 - INFO -    cb_focal_gamma: 2.003490771719691
2025-08-08 18:42:05,834 - INFO -    min_class_boost: 4.409153803732548
2025-08-08 18:42:05,834 - INFO -    oversample_strategy: boosted
2025-08-08 18:42:05,834 - INFO -    min_samples_factor: 3
