2025-08-18 01:09:34,784 - INFO - Starting optimization for residual_sage
2025-08-18 01:09:34,784 - INFO - Log file: optimization_logs/residual_sage_optimization_20250818_010934.log
2025-08-18 01:09:34,786 - INFO - 🚀 Starting hyperparameter optimization for residual_sage
2025-08-18 01:09:34,786 - INFO - 📋 Configuration:
2025-08-18 01:09:34,786 - INFO -    Task type: classification
2025-08-18 01:09:34,786 - INFO -    Trials: 10
2025-08-18 01:09:34,786 - INFO -    CV folds: 3
2025-08-18 01:09:34,786 - INFO -    Epochs per trial: 20
2025-08-18 01:09:34,786 - INFO -    Device: mps
2025-08-18 01:09:34,786 - INFO -    Direction: maximize
2025-08-18 01:09:34,787 - INFO - 📊 Class distribution:
2025-08-18 01:09:34,787 - INFO -    Class 0: 267162 samples (70.3%)
2025-08-18 01:09:34,787 - INFO -    Class 1: 110786 samples (29.2%)
2025-08-18 01:09:34,787 - INFO -    Class 2: 1902 samples (0.5%)
2025-08-18 01:09:34,788 - INFO - 🔍 Starting optimization with 10 trials...
2025-08-18 01:09:34,788 - INFO - 🔄 Starting trial 0
2025-08-18 01:09:34,788 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 01:09:34,790 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 4, 'dropout': 0.12857625042630305, 'lr': 0.0014210038443314222, 'weight_decay': 0.0001976659933872244, 'cb_focal_beta': 0.9998526061340614, 'cb_focal_gamma': 3.45893069388819, 'min_class_boost': 3.7738191565044854, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-18 01:09:34,790 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 01:16:42,224 - INFO -    📈 Results: Overall Acc=0.7974
2025-08-18 01:16:42,226 - INFO -    ✅ Trial 0 completed successfully
2025-08-18 01:16:42,227 - INFO - 🎯 Trial 1/10 (10.0%): Score = 0.7974
2025-08-18 01:16:42,227 - INFO - 🔄 Starting trial 1
2025-08-18 01:16:42,227 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 01:16:42,232 - INFO -    📊 Parameters: {'hidden_dim': 256, 'num_layers': 2, 'dropout': 0.49468933266469983, 'lr': 0.052710884856580736, 'weight_decay': 7.232977117746845e-05, 'focal_alpha': 2.4028372453393936, 'focal_gamma': 2.064079706669485, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-18 01:16:42,232 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 01:24:45,376 - INFO -    📈 Results: Overall Acc=0.7751
2025-08-18 01:24:45,438 - INFO -    ✅ Trial 1 completed successfully
2025-08-18 01:24:45,438 - INFO - 🎯 Trial 2/10 (20.0%): Score = 0.7751
2025-08-18 01:24:45,439 - INFO - 🔄 Starting trial 2
2025-08-18 01:24:45,439 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 01:24:45,444 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 2, 'dropout': 0.18492226716543783, 'lr': 0.014840430958964644, 'weight_decay': 0.0006729363131044037, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-18 01:24:45,444 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 01:32:36,277 - INFO -    📈 Results: Overall Acc=0.7941
2025-08-18 01:32:36,280 - INFO -    ✅ Trial 2 completed successfully
2025-08-18 01:32:36,280 - INFO - 🎯 Trial 3/10 (30.0%): Score = 0.7941
2025-08-18 01:32:36,280 - INFO - 🔄 Starting trial 3
2025-08-18 01:32:36,280 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 01:32:36,285 - INFO -    📊 Parameters: {'hidden_dim': 256, 'num_layers': 3, 'dropout': 0.5216621460477405, 'lr': 0.00017570778702968376, 'weight_decay': 1.0318364606821145e-05, 'oversample_strategy': 'boosted', 'min_samples_factor': 4}
2025-08-18 01:32:36,285 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 01:40:36,178 - INFO -    📈 Results: Overall Acc=0.7843
2025-08-18 01:40:36,181 - INFO -    ✅ Trial 3 completed successfully
2025-08-18 01:40:36,181 - INFO - 🎯 Trial 4/10 (40.0%): Score = 0.7843
2025-08-18 01:40:36,181 - INFO - 🔄 Starting trial 4
2025-08-18 01:40:36,181 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 01:40:36,186 - INFO -    📊 Parameters: {'hidden_dim': 64, 'num_layers': 2, 'dropout': 0.1207960435309019, 'lr': 0.0014178873075022817, 'weight_decay': 4.2665437845303326e-06, 'focal_alpha': 1.3088234425151735, 'focal_gamma': 2.4415271957115205, 'oversample_strategy': 'boosted', 'min_samples_factor': 4}
2025-08-18 01:40:36,186 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 01:48:23,739 - INFO -    📈 Results: Overall Acc=0.7930
2025-08-18 01:48:23,742 - INFO -    ✅ Trial 4 completed successfully
2025-08-18 01:48:23,743 - INFO - 🎯 Trial 5/10 (50.0%): Score = 0.7930
2025-08-18 01:48:23,744 - INFO - 📊 Progress Update - 5 trials completed
2025-08-18 01:48:23,744 - INFO -    🏆 Best score so far: 0.7974 (Trial #0)
2025-08-18 01:48:23,744 - INFO -    ⏱️  ETA: 38.8 minutes remaining
2025-08-18 01:48:23,745 - INFO - 🔄 Starting trial 5
2025-08-18 01:48:23,745 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 01:48:23,749 - INFO -    📊 Parameters: {'hidden_dim': 32, 'num_layers': 2, 'dropout': 0.6541123529383537, 'lr': 0.019477387181801812, 'weight_decay': 1.134979203045711e-06, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-18 01:48:23,749 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 01:56:33,948 - INFO -    📈 Results: Overall Acc=0.7968
2025-08-18 01:56:34,026 - INFO -    ✅ Trial 5 completed successfully
2025-08-18 01:56:34,026 - INFO - 🎯 Trial 6/10 (60.0%): Score = 0.7968
2025-08-18 01:56:34,026 - INFO - 🔄 Starting trial 6
2025-08-18 01:56:34,026 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 01:56:34,032 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 4, 'dropout': 0.15847209205625673, 'lr': 0.02747626297184438, 'weight_decay': 6.078141645209841e-05, 'cb_focal_beta': 0.9992657102916902, 'cb_focal_gamma': 3.0247645149120137, 'min_class_boost': 3.8559972737412065, 'oversample_strategy': 'boosted', 'min_samples_factor': 2}
2025-08-18 01:56:34,032 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 02:04:31,571 - INFO -    📈 Results: Overall Acc=0.7933
2025-08-18 02:04:31,628 - INFO -    ✅ Trial 6 completed successfully
2025-08-18 02:04:31,628 - INFO - 🎯 Trial 7/10 (70.0%): Score = 0.7933
2025-08-18 02:04:31,629 - INFO - 🔄 Starting trial 7
2025-08-18 02:04:31,629 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 02:04:31,633 - INFO -    📊 Parameters: {'hidden_dim': 256, 'num_layers': 2, 'dropout': 0.6113193524131764, 'lr': 0.006747174410005991, 'weight_decay': 0.003992939156236766, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-18 02:04:31,633 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 02:13:04,609 - INFO -    📈 Results: Overall Acc=0.7887
2025-08-18 02:13:04,612 - INFO -    ✅ Trial 7 completed successfully
2025-08-18 02:13:04,612 - INFO - 🎯 Trial 8/10 (80.0%): Score = 0.7887
2025-08-18 02:13:04,613 - INFO - 🔄 Starting trial 8
2025-08-18 02:13:04,613 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 02:13:04,617 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 3, 'dropout': 0.2775506413485783, 'lr': 0.0003399564606541974, 'weight_decay': 2.1308907301232063e-05, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-18 02:13:04,617 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 02:20:35,531 - INFO -    📈 Results: Overall Acc=0.7850
2025-08-18 02:20:35,598 - INFO -    ✅ Trial 8 completed successfully
2025-08-18 02:20:35,599 - INFO - 🎯 Trial 9/10 (90.0%): Score = 0.7850
2025-08-18 02:20:35,599 - INFO - 🔄 Starting trial 9
2025-08-18 02:20:35,600 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 02:20:35,604 - INFO -    📊 Parameters: {'hidden_dim': 256, 'num_layers': 4, 'dropout': 0.14285125048433955, 'lr': 0.000219358989142795, 'weight_decay': 9.837411870723828e-05, 'oversample_strategy': 'boosted', 'min_samples_factor': 2}
2025-08-18 02:20:35,604 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 02:28:17,401 - INFO -    📈 Results: Overall Acc=0.7986
2025-08-18 02:28:17,404 - INFO -    ✅ Trial 9 completed successfully
2025-08-18 02:28:17,404 - INFO - 🎯 Trial 10/10 (100.0%): Score = 0.7986
2025-08-18 02:28:17,405 - INFO - 📊 Progress Update - 10 trials completed
2025-08-18 02:28:17,405 - INFO -    🏆 Best score so far: 0.7986 (Trial #9)
2025-08-18 02:28:17,407 - INFO -    ⏱️  ETA: 0.0 minutes remaining
2025-08-18 02:28:17,407 - INFO - 
🎉 OPTIMIZATION COMPLETED!
2025-08-18 02:28:17,407 - INFO - ============================================================
2025-08-18 02:28:17,407 - INFO - 📋 Summary:
2025-08-18 02:28:17,407 - INFO -    Total trials: 10
2025-08-18 02:28:17,407 - INFO -    Best trial: #9
2025-08-18 02:28:17,407 - INFO -    Best value: 0.7986
2025-08-18 02:28:17,408 - INFO - 🏆 Best parameters:
2025-08-18 02:28:17,408 - INFO -    hidden_dim: 256
2025-08-18 02:28:17,408 - INFO -    num_layers: 4
2025-08-18 02:28:17,408 - INFO -    dropout: 0.14285125048433955
2025-08-18 02:28:17,408 - INFO -    lr: 0.000219358989142795
2025-08-18 02:28:17,408 - INFO -    weight_decay: 9.837411870723828e-05
2025-08-18 02:28:17,408 - INFO -    loss_type: weighted_ce
2025-08-18 02:28:17,408 - INFO -    oversample_strategy: boosted
2025-08-18 02:28:17,408 - INFO -    min_samples_factor: 2
