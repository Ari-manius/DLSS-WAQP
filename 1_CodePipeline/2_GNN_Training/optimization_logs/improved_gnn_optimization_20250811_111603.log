2025-08-11 11:16:03,540 - INFO - Starting optimization for improved_gnn
2025-08-11 11:16:03,540 - INFO - Log file: optimization_logs/improved_gnn_optimization_20250811_111603.log
2025-08-11 11:16:03,542 - INFO - 🚀 Starting hyperparameter optimization for improved_gnn
2025-08-11 11:16:03,542 - INFO - 📋 Configuration:
2025-08-11 11:16:03,542 - INFO -    Task type: classification
2025-08-11 11:16:03,542 - INFO -    Trials: 5
2025-08-11 11:16:03,542 - INFO -    CV folds: 3
2025-08-11 11:16:03,542 - INFO -    Epochs per trial: 10
2025-08-11 11:16:03,542 - INFO -    Device: mps
2025-08-11 11:16:03,542 - INFO -    Direction: maximize
2025-08-11 11:16:03,544 - INFO - 📊 Class distribution:
2025-08-11 11:16:03,544 - INFO -    Class 0: 267170 samples (70.3%)
2025-08-11 11:16:03,544 - INFO -    Class 1: 110778 samples (29.2%)
2025-08-11 11:16:03,544 - INFO -    Class 2: 1902 samples (0.5%)
2025-08-11 11:16:03,544 - INFO - 🔍 Starting optimization with 5 trials...
2025-08-11 11:16:03,544 - INFO - 🔄 Starting trial 0
2025-08-11 11:16:03,544 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-11 11:16:03,547 - INFO -    📊 Parameters: {'hidden_dim': 32, 'num_layers': 2, 'dropout': 0.15255830839432633, 'lr': 0.02816954129769643, 'weight_decay': 0.002819776817339208, 'cb_focal_beta': 0.9991312106711121, 'cb_focal_gamma': 2.9184185707596004, 'min_class_boost': 4.928171808823148, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-11 11:16:03,547 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-11 11:28:21,933 - ERROR -    ❌ Trial 0 failed: invalid low watermark ratio 1.4
2025-08-11 11:28:21,949 - INFO - 🎯 Trial 1/5 (20.0%): Score = -inf
2025-08-11 11:28:21,949 - INFO - 🔄 Starting trial 1
2025-08-11 11:28:21,949 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-11 11:28:21,962 - INFO -    📊 Parameters: {'hidden_dim': 256, 'num_layers': 4, 'dropout': 0.2836643120491267, 'lr': 0.004055827731738365, 'weight_decay': 0.006491803900598818, 'focal_alpha': 1.0333269708149384, 'focal_gamma': 3.786391489318132, 'oversample_strategy': 'balanced', 'min_samples_factor': 2}
2025-08-11 11:28:21,962 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-11 11:40:02,286 - ERROR -    ❌ Trial 1 failed: invalid low watermark ratio 1.4
2025-08-11 11:40:02,301 - INFO - 🎯 Trial 2/5 (40.0%): Score = -inf
2025-08-11 11:40:02,302 - INFO - 🔄 Starting trial 2
2025-08-11 11:40:02,302 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-11 11:40:02,316 - INFO -    📊 Parameters: {'hidden_dim': 64, 'num_layers': 2, 'dropout': 0.5511228356159912, 'lr': 0.0005379129523870875, 'weight_decay': 0.00032663223831806633, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-11 11:40:02,316 - INFO -    🔬 Running 3-fold cross-validation...
