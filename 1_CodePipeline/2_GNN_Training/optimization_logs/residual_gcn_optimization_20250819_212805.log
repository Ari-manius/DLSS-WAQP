2025-08-19 21:28:05,873 - INFO - Starting optimization for residual_gcn
2025-08-19 21:28:05,873 - INFO - Log file: optimization_logs/residual_gcn_optimization_20250819_212805.log
2025-08-19 21:28:05,875 - INFO - 🚀 Starting hyperparameter optimization for residual_gcn
2025-08-19 21:28:05,875 - INFO - 📋 Configuration:
2025-08-19 21:28:05,875 - INFO -    Task type: classification
2025-08-19 21:28:05,875 - INFO -    Trials: 16
2025-08-19 21:28:05,875 - INFO -    CV folds: 2
2025-08-19 21:28:05,875 - INFO -    Epochs per trial: 20
2025-08-19 21:28:05,875 - INFO -    Device: mps
2025-08-19 21:28:05,875 - INFO -    Direction: maximize
2025-08-19 21:28:05,876 - INFO - 📊 Class distribution:
2025-08-19 21:28:05,876 - INFO -    Class 0: 267162 samples (70.3%)
2025-08-19 21:28:05,876 - INFO -    Class 1: 110786 samples (29.2%)
2025-08-19 21:28:05,876 - INFO -    Class 2: 1902 samples (0.5%)
2025-08-19 21:28:05,877 - INFO - 🔍 Starting optimization with 16 trials...
2025-08-19 21:28:05,877 - INFO - 🔄 Starting trial 0
2025-08-19 21:28:05,877 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 21:28:05,880 - INFO -    📊 Parameters: {'dropout': 0.09942990673111458, 'weight_decay': 0.0005814315762674602, 'lr': 0.006400216779995206, 'hidden_dim': 64, 'num_layers': 2, 'focal_alpha': 1.098700755882307, 'focal_gamma': 2.926248505850804, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-19 21:28:05,880 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 21:33:32,173 - INFO -    📈 Results: Overall Acc=0.7690
2025-08-19 21:33:32,175 - INFO -    ✅ Trial 0 completed successfully
2025-08-19 21:33:32,175 - INFO - 🎯 Trial 1/16 (6.2%): Score = 0.7690
2025-08-19 21:33:32,176 - INFO - 🔄 Starting trial 1
2025-08-19 21:33:32,176 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 21:33:32,180 - INFO -    📊 Parameters: {'dropout': 0.6429584827962512, 'weight_decay': 0.006009114528543365, 'lr': 0.05417848909720591, 'hidden_dim': 32, 'num_layers': 3, 'cb_focal_beta': 0.9997443178465006, 'cb_focal_gamma': 3.0237360109275526, 'min_class_boost': 4.169572639806336, 'oversample_strategy': 'boosted', 'min_samples_factor': 4}
2025-08-19 21:33:32,180 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 21:39:21,689 - INFO -    📈 Results: Overall Acc=0.7268
2025-08-19 21:39:21,692 - INFO -    ✅ Trial 1 completed successfully
2025-08-19 21:39:21,693 - INFO - 🎯 Trial 2/16 (12.5%): Score = 0.7268
2025-08-19 21:39:21,693 - INFO - 🔄 Starting trial 2
2025-08-19 21:39:21,693 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 21:39:21,697 - INFO -    📊 Parameters: {'dropout': 0.023807762228250144, 'weight_decay': 0.00034288826220045776, 'lr': 0.028112512210506677, 'hidden_dim': 32, 'num_layers': 2, 'cb_focal_beta': 0.9992403148058226, 'cb_focal_gamma': 3.6862328658694574, 'min_class_boost': 2.3409400063335553, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-19 21:39:21,697 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 21:45:09,422 - INFO -    📈 Results: Overall Acc=0.7660
2025-08-19 21:45:09,427 - INFO -    ✅ Trial 2 completed successfully
2025-08-19 21:45:09,427 - INFO - 🎯 Trial 3/16 (18.8%): Score = 0.7660
2025-08-19 21:45:09,427 - INFO - 🔄 Starting trial 3
2025-08-19 21:45:09,427 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 21:45:09,432 - INFO -    📊 Parameters: {'dropout': 0.46432518083655727, 'weight_decay': 0.000409508283978004, 'lr': 0.004747551338389226, 'hidden_dim': 128, 'num_layers': 5, 'cb_focal_beta': 0.9998208217219444, 'cb_focal_gamma': 2.5323852229843062, 'min_class_boost': 2.4199114868682687, 'oversample_strategy': 'boosted', 'min_samples_factor': 3}
2025-08-19 21:45:09,432 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 21:50:47,690 - INFO -    📈 Results: Overall Acc=0.7217
2025-08-19 21:50:47,692 - INFO -    ✅ Trial 3 completed successfully
2025-08-19 21:50:47,693 - INFO - 🎯 Trial 4/16 (25.0%): Score = 0.7217
2025-08-19 21:50:47,693 - INFO - 🔄 Starting trial 4
2025-08-19 21:50:47,693 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 21:50:47,700 - INFO -    📊 Parameters: {'dropout': 0.4329556209802038, 'weight_decay': 1.4265758121765818e-06, 'lr': 0.05137740266190755, 'hidden_dim': 128, 'num_layers': 4, 'oversample_strategy': 'boosted', 'min_samples_factor': 2}
2025-08-19 21:50:47,700 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 21:56:25,819 - INFO -    📈 Results: Overall Acc=0.7077
2025-08-19 21:56:25,823 - INFO -    ✅ Trial 4 completed successfully
2025-08-19 21:56:25,823 - INFO - 🎯 Trial 5/16 (31.2%): Score = 0.7077
2025-08-19 21:56:25,824 - INFO - 📊 Progress Update - 5 trials completed
2025-08-19 21:56:25,824 - INFO -    🏆 Best score so far: 0.7690 (Trial #0)
2025-08-19 21:56:25,824 - INFO -    ⏱️  ETA: 62.3 minutes remaining
2025-08-19 21:56:25,825 - INFO - 🔄 Starting trial 5
2025-08-19 21:56:25,825 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 21:56:25,829 - INFO -    📊 Parameters: {'dropout': 0.6780657576354029, 'weight_decay': 0.0001329779530332499, 'lr': 0.02768684769823935, 'hidden_dim': 64, 'num_layers': 3, 'focal_alpha': 1.9615683886463267, 'focal_gamma': 2.4706670302483182, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-19 21:56:25,829 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:02:18,613 - INFO -    📈 Results: Overall Acc=0.7495
2025-08-19 22:02:18,617 - INFO -    ✅ Trial 5 completed successfully
2025-08-19 22:02:18,617 - INFO - 🎯 Trial 6/16 (37.5%): Score = 0.7495
2025-08-19 22:02:18,618 - INFO - 🔄 Starting trial 6
2025-08-19 22:02:18,618 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 22:02:18,623 - INFO -    📊 Parameters: {'dropout': 0.1531166951219045, 'weight_decay': 4.674655823239751e-06, 'lr': 0.0010444274692895496, 'hidden_dim': 32, 'num_layers': 3, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-19 22:02:18,623 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:07:49,465 - INFO -    📈 Results: Overall Acc=0.7243
2025-08-19 22:07:49,469 - INFO -    ✅ Trial 6 completed successfully
2025-08-19 22:07:49,469 - INFO - 🎯 Trial 7/16 (43.8%): Score = 0.7243
2025-08-19 22:07:49,470 - INFO - 🔄 Starting trial 7
2025-08-19 22:07:49,470 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 22:07:49,476 - INFO -    📊 Parameters: {'dropout': 0.1134805618904263, 'weight_decay': 0.007234971256907242, 'lr': 0.0020332262249637217, 'hidden_dim': 64, 'num_layers': 4, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-19 22:07:49,476 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:13:41,263 - INFO -    📈 Results: Overall Acc=0.7508
2025-08-19 22:13:41,344 - INFO -    ✅ Trial 7 completed successfully
2025-08-19 22:13:41,344 - INFO - 🎯 Trial 8/16 (50.0%): Score = 0.7508
2025-08-19 22:13:41,345 - INFO - 🔄 Starting trial 8
2025-08-19 22:13:41,345 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 22:13:41,351 - INFO -    📊 Parameters: {'dropout': 0.3172223006853727, 'weight_decay': 0.000481518139325438, 'lr': 0.00041851714448025635, 'hidden_dim': 64, 'num_layers': 5, 'focal_alpha': 2.705068206062461, 'focal_gamma': 2.591355735369651, 'oversample_strategy': 'boosted', 'min_samples_factor': 2}
2025-08-19 22:13:41,351 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:18:40,007 - INFO -    📈 Results: Overall Acc=0.6938
2025-08-19 22:18:40,010 - INFO -    ✅ Trial 8 completed successfully
2025-08-19 22:18:40,010 - INFO - 🎯 Trial 9/16 (56.2%): Score = 0.6938
2025-08-19 22:18:40,011 - INFO - 🔄 Starting trial 9
2025-08-19 22:18:40,011 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 22:18:40,016 - INFO -    📊 Parameters: {'dropout': 0.10905127772018469, 'weight_decay': 0.0038246321516815403, 'lr': 0.0001385121095632608, 'hidden_dim': 256, 'num_layers': 2, 'oversample_strategy': 'boosted', 'min_samples_factor': 3}
2025-08-19 22:18:40,016 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:24:06,256 - INFO -    📈 Results: Overall Acc=0.7567
2025-08-19 22:24:06,259 - INFO -    ✅ Trial 9 completed successfully
2025-08-19 22:24:06,260 - INFO - 🎯 Trial 10/16 (62.5%): Score = 0.7567
2025-08-19 22:24:06,261 - INFO - 📊 Progress Update - 10 trials completed
2025-08-19 22:24:06,261 - INFO -    🏆 Best score so far: 0.7690 (Trial #0)
2025-08-19 22:24:06,263 - INFO -    ⏱️  ETA: 33.6 minutes remaining
2025-08-19 22:24:06,263 - INFO - 🔄 Starting trial 10
2025-08-19 22:24:06,263 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 22:24:06,282 - INFO -    📊 Parameters: {'dropout': 0.29958312079162525, 'weight_decay': 1.955022449599883e-05, 'lr': 0.005797553568779859, 'hidden_dim': 256, 'num_layers': 2, 'focal_alpha': 1.053634762743494, 'focal_gamma': 3.8276414800172276, 'oversample_strategy': 'balanced', 'min_samples_factor': 2}
2025-08-19 22:24:06,282 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:29:33,152 - INFO -    📈 Results: Overall Acc=0.3802
2025-08-19 22:29:33,156 - INFO -    ✅ Trial 10 completed successfully
2025-08-19 22:29:33,156 - INFO - 🎯 Trial 11/16 (68.8%): Score = 0.3802
2025-08-19 22:29:33,157 - INFO - 🔄 Starting trial 11
2025-08-19 22:29:33,157 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 22:29:33,175 - INFO -    📊 Parameters: {'dropout': 0.021014216481402614, 'weight_decay': 0.0008086534455835116, 'lr': 0.015224911831402366, 'hidden_dim': 32, 'num_layers': 2, 'cb_focal_beta': 0.9990672167459161, 'cb_focal_gamma': 3.8467988371740134, 'min_class_boost': 2.116941013762402, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-19 22:29:33,175 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:35:06,413 - INFO -    📈 Results: Overall Acc=0.7683
2025-08-19 22:35:06,416 - INFO -    ✅ Trial 11 completed successfully
2025-08-19 22:35:06,416 - INFO - 🎯 Trial 12/16 (75.0%): Score = 0.7683
2025-08-19 22:35:06,417 - INFO - 🔄 Starting trial 12
2025-08-19 22:35:06,417 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 22:35:06,432 - INFO -    📊 Parameters: {'dropout': 0.02961913936301593, 'weight_decay': 0.001538122644464449, 'lr': 0.009718616397356347, 'hidden_dim': 64, 'num_layers': 2, 'focal_alpha': 1.0002464122648405, 'focal_gamma': 3.387263919095113, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-19 22:35:06,433 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:40:12,756 - INFO -    📈 Results: Overall Acc=0.7718
2025-08-19 22:40:12,760 - INFO -    ✅ Trial 12 completed successfully
2025-08-19 22:40:12,760 - INFO - 🎯 Trial 13/16 (81.2%): Score = 0.7718
2025-08-19 22:40:12,761 - INFO - 🔄 Starting trial 13
2025-08-19 22:40:12,761 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 22:40:12,777 - INFO -    📊 Parameters: {'dropout': 0.22562901959098236, 'weight_decay': 0.0014494243069379485, 'lr': 0.010041078311870883, 'hidden_dim': 64, 'num_layers': 2, 'focal_alpha': 1.0370799581742471, 'focal_gamma': 3.379963119794137, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-19 22:40:12,777 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:45:49,082 - INFO -    📈 Results: Overall Acc=0.7655
2025-08-19 22:45:49,085 - INFO -    ✅ Trial 13 completed successfully
2025-08-19 22:45:49,085 - INFO - 🎯 Trial 14/16 (87.5%): Score = 0.7655
2025-08-19 22:45:49,086 - INFO - 🔄 Starting trial 14
2025-08-19 22:45:49,086 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 22:45:49,102 - INFO -    📊 Parameters: {'dropout': 0.20269237726444483, 'weight_decay': 8.872993212711606e-05, 'lr': 0.0020281252154965407, 'hidden_dim': 64, 'num_layers': 3, 'focal_alpha': 1.520854877640434, 'focal_gamma': 3.153441159341643, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-19 22:45:49,102 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:51:14,259 - INFO -    📈 Results: Overall Acc=0.3758
2025-08-19 22:51:14,330 - INFO -    ✅ Trial 14 completed successfully
2025-08-19 22:51:14,330 - INFO - 🎯 Trial 15/16 (93.8%): Score = 0.3758
2025-08-19 22:51:14,333 - INFO - 📊 Progress Update - 15 trials completed
2025-08-19 22:51:14,333 - INFO -    🏆 Best score so far: 0.7718 (Trial #12)
2025-08-19 22:51:14,336 - INFO -    ⏱️  ETA: 5.5 minutes remaining
2025-08-19 22:51:14,336 - INFO - 🔄 Starting trial 15
2025-08-19 22:51:14,336 - INFO -    Device: mps, Task: classification, CV folds: 2
2025-08-19 22:51:14,353 - INFO -    📊 Parameters: {'dropout': 0.025991626711720877, 'weight_decay': 0.001805390526903191, 'lr': 0.010495901808917529, 'hidden_dim': 64, 'num_layers': 2, 'focal_alpha': 1.4649275807873057, 'focal_gamma': 3.0310105835559997, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-19 22:51:14,353 - INFO -    🔬 Running 2-fold cross-validation...
2025-08-19 22:56:45,285 - INFO -    📈 Results: Overall Acc=0.7712
2025-08-19 22:56:45,288 - INFO -    ✅ Trial 15 completed successfully
2025-08-19 22:56:45,289 - INFO - 🎯 Trial 16/16 (100.0%): Score = 0.7712
2025-08-19 22:56:45,290 - INFO - 
🎉 OPTIMIZATION COMPLETED!
2025-08-19 22:56:45,290 - INFO - ============================================================
2025-08-19 22:56:45,290 - INFO - 📋 Summary:
2025-08-19 22:56:45,291 - INFO -    Total trials: 16
2025-08-19 22:56:45,291 - INFO -    Best trial: #12
2025-08-19 22:56:45,291 - INFO -    Best value: 0.7718
2025-08-19 22:56:45,291 - INFO - 🏆 Best parameters:
2025-08-19 22:56:45,291 - INFO -    dropout: 0.02961913936301593
2025-08-19 22:56:45,291 - INFO -    weight_decay: 0.001538122644464449
2025-08-19 22:56:45,291 - INFO -    lr: 0.009718616397356347
2025-08-19 22:56:45,291 - INFO -    hidden_dim: 64
2025-08-19 22:56:45,291 - INFO -    num_layers: 2
2025-08-19 22:56:45,291 - INFO -    loss_type: focal
2025-08-19 22:56:45,291 - INFO -    focal_alpha: 1.0002464122648405
2025-08-19 22:56:45,291 - INFO -    focal_gamma: 3.387263919095113
2025-08-19 22:56:45,291 - INFO -    oversample_strategy: balanced
2025-08-19 22:56:45,291 - INFO -    min_samples_factor: 4
