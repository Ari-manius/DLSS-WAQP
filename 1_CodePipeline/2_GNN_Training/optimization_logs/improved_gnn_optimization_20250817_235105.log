2025-08-17 23:51:05,291 - INFO - Starting optimization for improved_gnn
2025-08-17 23:51:05,291 - INFO - Log file: optimization_logs/improved_gnn_optimization_20250817_235105.log
2025-08-17 23:51:05,293 - INFO - 🚀 Starting hyperparameter optimization for improved_gnn
2025-08-17 23:51:05,293 - INFO - 📋 Configuration:
2025-08-17 23:51:05,293 - INFO -    Task type: classification
2025-08-17 23:51:05,293 - INFO -    Trials: 10
2025-08-17 23:51:05,293 - INFO -    CV folds: 3
2025-08-17 23:51:05,293 - INFO -    Epochs per trial: 20
2025-08-17 23:51:05,293 - INFO -    Device: mps
2025-08-17 23:51:05,293 - INFO -    Direction: maximize
2025-08-17 23:51:05,294 - INFO - 📊 Class distribution:
2025-08-17 23:51:05,295 - INFO -    Class 0: 267162 samples (70.3%)
2025-08-17 23:51:05,295 - INFO -    Class 1: 110786 samples (29.2%)
2025-08-17 23:51:05,295 - INFO -    Class 2: 1902 samples (0.5%)
2025-08-17 23:51:05,295 - INFO - 🔍 Starting optimization with 10 trials...
2025-08-17 23:51:05,295 - INFO - 🔄 Starting trial 0
2025-08-17 23:51:05,295 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-17 23:51:05,297 - INFO -    📊 Parameters: {'hidden_dim': 32, 'num_layers': 4, 'dropout': 0.18380010416094977, 'lr': 0.00010090376038496337, 'weight_decay': 1.927308982242447e-05, 'cb_focal_beta': 0.999831510828507, 'cb_focal_gamma': 2.3726896417256107, 'min_class_boost': 2.3238411181194945, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-17 23:51:05,297 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-17 23:58:24,039 - INFO -    📈 Results: Overall Acc=0.5996
2025-08-17 23:58:24,041 - INFO -    ✅ Trial 0 completed successfully
2025-08-17 23:58:24,041 - INFO - 🎯 Trial 1/10 (10.0%): Score = 0.5996
2025-08-17 23:58:24,041 - INFO - 🔄 Starting trial 1
2025-08-17 23:58:24,041 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-17 23:58:24,046 - INFO -    📊 Parameters: {'hidden_dim': 32, 'num_layers': 3, 'dropout': 0.3871834034379059, 'lr': 0.05468809143770204, 'weight_decay': 9.247640681359524e-06, 'focal_alpha': 2.25787549650384, 'focal_gamma': 2.001506272285612, 'oversample_strategy': 'boosted', 'min_samples_factor': 4}
2025-08-17 23:58:24,046 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 00:05:33,355 - INFO -    📈 Results: Overall Acc=0.7380
2025-08-18 00:05:33,358 - INFO -    ✅ Trial 1 completed successfully
2025-08-18 00:05:33,358 - INFO - 🎯 Trial 2/10 (20.0%): Score = 0.7380
2025-08-18 00:05:33,358 - INFO - 🔄 Starting trial 2
2025-08-18 00:05:33,358 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 00:05:33,363 - INFO -    📊 Parameters: {'hidden_dim': 256, 'num_layers': 2, 'dropout': 0.4983664447860865, 'lr': 0.004898639767026428, 'weight_decay': 0.0012765839050431782, 'oversample_strategy': 'boosted', 'min_samples_factor': 4}
2025-08-18 00:05:33,363 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 00:13:29,522 - INFO -    📈 Results: Overall Acc=0.7879
2025-08-18 00:13:29,525 - INFO -    ✅ Trial 2 completed successfully
2025-08-18 00:13:29,525 - INFO - 🎯 Trial 3/10 (30.0%): Score = 0.7879
2025-08-18 00:13:29,526 - INFO - 🔄 Starting trial 3
2025-08-18 00:13:29,526 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 00:13:29,530 - INFO -    📊 Parameters: {'hidden_dim': 32, 'num_layers': 2, 'dropout': 0.30262155846739036, 'lr': 0.0844916065036158, 'weight_decay': 3.475165410908951e-06, 'cb_focal_beta': 0.9992381846028281, 'cb_focal_gamma': 2.2167004876652765, 'min_class_boost': 3.364187900004835, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-18 00:13:29,530 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 00:21:34,271 - INFO -    📈 Results: Overall Acc=0.6434
2025-08-18 00:21:34,274 - INFO -    ✅ Trial 3 completed successfully
2025-08-18 00:21:34,274 - INFO - 🎯 Trial 4/10 (40.0%): Score = 0.6434
2025-08-18 00:21:34,274 - INFO - 🔄 Starting trial 4
2025-08-18 00:21:34,274 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 00:21:34,279 - INFO -    📊 Parameters: {'hidden_dim': 64, 'num_layers': 3, 'dropout': 0.6271231081459842, 'lr': 0.07491867389063941, 'weight_decay': 0.0007048708914657858, 'cb_focal_beta': 0.9991690881947137, 'cb_focal_gamma': 2.668107777629351, 'min_class_boost': 2.895864062298949, 'oversample_strategy': 'balanced', 'min_samples_factor': 2}
2025-08-18 00:21:34,279 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 00:29:27,141 - INFO -    📈 Results: Overall Acc=0.6566
2025-08-18 00:29:27,218 - INFO -    ✅ Trial 4 completed successfully
2025-08-18 00:29:27,218 - INFO - 🎯 Trial 5/10 (50.0%): Score = 0.6566
2025-08-18 00:29:27,220 - INFO - 📊 Progress Update - 5 trials completed
2025-08-18 00:29:27,220 - INFO -    🏆 Best score so far: 0.7879 (Trial #2)
2025-08-18 00:29:27,221 - INFO -    ⏱️  ETA: 38.4 minutes remaining
2025-08-18 00:29:27,221 - INFO - 🔄 Starting trial 5
2025-08-18 00:29:27,221 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 00:29:27,227 - INFO -    📊 Parameters: {'hidden_dim': 256, 'num_layers': 2, 'dropout': 0.558995378565042, 'lr': 0.0014961150058137055, 'weight_decay': 1.5215003004005843e-06, 'oversample_strategy': 'boosted', 'min_samples_factor': 2}
2025-08-18 00:29:27,227 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 00:37:25,681 - INFO -    📈 Results: Overall Acc=0.7990
2025-08-18 00:37:25,684 - INFO -    ✅ Trial 5 completed successfully
2025-08-18 00:37:25,685 - INFO - 🎯 Trial 6/10 (60.0%): Score = 0.7990
2025-08-18 00:37:25,685 - INFO - 🔄 Starting trial 6
2025-08-18 00:37:25,685 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 00:37:25,690 - INFO -    📊 Parameters: {'hidden_dim': 64, 'num_layers': 2, 'dropout': 0.35419004714793256, 'lr': 0.00011775507798427723, 'weight_decay': 0.002246296564237354, 'cb_focal_beta': 0.9996955967963594, 'cb_focal_gamma': 3.5052612673213224, 'min_class_boost': 4.265657787331477, 'oversample_strategy': 'balanced', 'min_samples_factor': 3}
2025-08-18 00:37:25,690 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 00:45:37,828 - INFO -    📈 Results: Overall Acc=0.5913
2025-08-18 00:45:37,832 - INFO -    ✅ Trial 6 completed successfully
2025-08-18 00:45:37,832 - INFO - 🎯 Trial 7/10 (70.0%): Score = 0.5913
2025-08-18 00:45:37,833 - INFO - 🔄 Starting trial 7
2025-08-18 00:45:37,833 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 00:45:37,838 - INFO -    📊 Parameters: {'hidden_dim': 128, 'num_layers': 3, 'dropout': 0.19284738478883495, 'lr': 0.005513841404942585, 'weight_decay': 6.8957667130635e-05, 'cb_focal_beta': 0.999410886294438, 'cb_focal_gamma': 2.148918971843276, 'min_class_boost': 2.3036662779400956, 'oversample_strategy': 'boosted', 'min_samples_factor': 2}
2025-08-18 00:45:37,838 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 00:53:31,504 - INFO -    📈 Results: Overall Acc=0.7966
2025-08-18 00:53:31,575 - INFO -    ✅ Trial 7 completed successfully
2025-08-18 00:53:31,576 - INFO - 🎯 Trial 8/10 (80.0%): Score = 0.7966
2025-08-18 00:53:31,576 - INFO - 🔄 Starting trial 8
2025-08-18 00:53:31,576 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 00:53:31,581 - INFO -    📊 Parameters: {'hidden_dim': 64, 'num_layers': 3, 'dropout': 0.5714982688499072, 'lr': 0.031924450245258224, 'weight_decay': 5.096471987875483e-05, 'cb_focal_beta': 0.9996798393731371, 'cb_focal_gamma': 2.4141039621721414, 'min_class_boost': 4.917890007622967, 'oversample_strategy': 'boosted', 'min_samples_factor': 2}
2025-08-18 00:53:31,581 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 01:01:26,668 - INFO -    📈 Results: Overall Acc=0.7852
2025-08-18 01:01:26,670 - INFO -    ✅ Trial 8 completed successfully
2025-08-18 01:01:26,671 - INFO - 🎯 Trial 9/10 (90.0%): Score = 0.7852
2025-08-18 01:01:26,671 - INFO - 🔄 Starting trial 9
2025-08-18 01:01:26,671 - INFO -    Device: mps, Task: classification, CV folds: 3
2025-08-18 01:01:26,676 - INFO -    📊 Parameters: {'hidden_dim': 256, 'num_layers': 3, 'dropout': 0.5027759824043367, 'lr': 0.0005963032950063406, 'weight_decay': 2.180966384127442e-05, 'cb_focal_beta': 0.9991298511294097, 'cb_focal_gamma': 2.742447039524128, 'min_class_boost': 4.108373100414013, 'oversample_strategy': 'balanced', 'min_samples_factor': 4}
2025-08-18 01:01:26,676 - INFO -    🔬 Running 3-fold cross-validation...
2025-08-18 01:09:20,553 - INFO -    📈 Results: Overall Acc=0.7977
2025-08-18 01:09:20,556 - INFO -    ✅ Trial 9 completed successfully
2025-08-18 01:09:20,556 - INFO - 🎯 Trial 10/10 (100.0%): Score = 0.7977
2025-08-18 01:09:20,558 - INFO - 📊 Progress Update - 10 trials completed
2025-08-18 01:09:20,558 - INFO -    🏆 Best score so far: 0.7990 (Trial #5)
2025-08-18 01:09:20,559 - INFO -    ⏱️  ETA: 0.0 minutes remaining
2025-08-18 01:09:20,559 - INFO - 
🎉 OPTIMIZATION COMPLETED!
2025-08-18 01:09:20,559 - INFO - ============================================================
2025-08-18 01:09:20,560 - INFO - 📋 Summary:
2025-08-18 01:09:20,560 - INFO -    Total trials: 10
2025-08-18 01:09:20,560 - INFO -    Best trial: #5
2025-08-18 01:09:20,560 - INFO -    Best value: 0.7990
2025-08-18 01:09:20,560 - INFO - 🏆 Best parameters:
2025-08-18 01:09:20,560 - INFO -    hidden_dim: 256
2025-08-18 01:09:20,560 - INFO -    num_layers: 2
2025-08-18 01:09:20,560 - INFO -    dropout: 0.558995378565042
2025-08-18 01:09:20,560 - INFO -    lr: 0.0014961150058137055
2025-08-18 01:09:20,560 - INFO -    weight_decay: 1.5215003004005843e-06
2025-08-18 01:09:20,561 - INFO -    loss_type: weighted_ce
2025-08-18 01:09:20,561 - INFO -    oversample_strategy: boosted
2025-08-18 01:09:20,561 - INFO -    min_samples_factor: 2
